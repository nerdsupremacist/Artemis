<div class="row justify-content-center">
    <div class="col-8">
        <div *ngIf="programmingExercise">
            <h2><span jhiTranslate="artemisApp.programmingExercise.detail.title">Programming Exercise</span> {{ programmingExercise.id }}</h2>
            <hr />
            <jhi-alert></jhi-alert>
            <jhi-alert-error></jhi-alert-error>
            <div class="text-right">
                <!--                <div class="btn-group flex-btn-group-container">-->
                <button
                    type="submit"
                    *ngIf="programmingExercise.isAtLeastInstructor"
                    routerLink="/exercise/{{ programmingExercise.id }}/hints"
                    class="btn btn-info btn-sm mr-1 mb-1"
                >
                    <fa-icon [icon]="'pencil-alt'"></fa-icon>
                    <span class="d-none d-md-inline" jhiTranslate="entity.action.manageHints">Manage Hints</span>
                </button>
                <button
                    type="submit"
                    *ngIf="programmingExercise.isAtLeastInstructor"
                    [routerLink]="['/', { outlets: { popup: 'exercise/' + programmingExercise.id + '/archive' } }]"
                    replaceUrl="true"
                    queryParamsHandling="merge"
                    class="btn btn-danger btn-sm mr-1 mb-1"
                >
                    <fa-icon [icon]="'archive'"></fa-icon>
                    <span class="d-none d-md-inline" jhiTranslate="entity.action.archive">Archive</span>
                </button>
                <button
                    type="submit"
                    *ngIf="programmingExercise.isAtLeastInstructor"
                    [routerLink]="['/', { outlets: { popup: 'exercise/' + programmingExercise.id + '/cleanup' } }]"
                    replaceUrl="true"
                    queryParamsHandling="merge"
                    class="btn btn-danger btn-sm mr-1 mb-1"
                >
                    <fa-icon [icon]="'eraser'"></fa-icon>
                    <span class="d-none d-md-inline" jhiTranslate="entity.action.cleanup">Cleanup</span>
                </button>
                <!--                </div>-->
            </div>
            <dl class="row-md jh-entity-details">
                <dt><span jhiTranslate="artemisApp.exercise.title">Title</span></dt>
                <dd>
                    <span>{{ programmingExercise.title }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.exercise.shortName">Short Name</span></dt>
                <dd>
                    <span>{{ programmingExercise.shortName }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.exercise.releaseDate">Release Date</span></dt>
                <dd>
                    <span>{{ programmingExercise.releaseDate | date: 'medium' }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.exercise.dueDate">Due Date</span></dt>
                <dd>
                    <span>{{ programmingExercise.dueDate | date: 'medium' }}</span>
                </dd>
                <ng-container *ngIf="programmingExercise.dueDate">
                    <dt><span jhiTranslate="artemisApp.programmingExercise.timeline.afterDueDate">Automatic Submission Run After Due Date</span></dt>
                    <dd>
                        <span>{{ programmingExercise.buildAndTestStudentSubmissionsAfterDueDate | date: 'medium' }}</span>
                    </dd>
                </ng-container>
                <dt><span jhiTranslate="artemisApp.exercise.maxScore">Max Score</span></dt>
                <dd>
                    <span>{{ programmingExercise.maxScore }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.exercise.presentationScoreEnabled.title">Presentation Score enabled</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.presentationScoreEnabled">{{ 'global.generic.yes' | translate }}</span>
                    <span *ngIf="!programmingExercise.presentationScoreEnabled">{{ 'global.generic.no' | translate }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.templateRepositoryUrl">Template Repository Url</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.templateParticipation && programmingExercise.templateParticipation.repositoryUrl"
                        ><a href="{{ programmingExercise.templateParticipation.repositoryUrl }}" target="_blank">{{
                            programmingExercise.templateParticipation.repositoryUrl
                        }}</a></span
                    >
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.solutionRepositoryUrl">Solution Repository Url</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.solutionParticipation && programmingExercise.solutionParticipation.repositoryUrl"
                        ><a href="{{ programmingExercise.solutionParticipation.repositoryUrl }}" target="_blank">{{
                            programmingExercise.solutionParticipation.repositoryUrl
                        }}</a></span
                    >
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.testRepositoryUrl">Test Repository Url</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.testRepositoryUrl"
                        ><a href="{{ programmingExercise.testRepositoryUrl }}" target="_blank">{{ programmingExercise.testRepositoryUrl }}</a></span
                    >
                </dd>

                <!-- TODO get the correct URL from the server instead of hardcoding Bamboo here -->
                <dt><span jhiTranslate="artemisApp.programmingExercise.templateBuildPlanId">Template Build Plan Id</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.templateParticipation && programmingExercise.templateParticipation.buildPlanId"
                        ><a href="https://bamboobruegge.in.tum.de/browse/{{ programmingExercise.templateParticipation.buildPlanId }}" target="_blank">{{
                            programmingExercise.templateParticipation.buildPlanId
                        }}</a></span
                    >
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.solutionBuildPlanId">Solution Build Plan Id</span></dt>
                <dd>
                    <span *ngIf="programmingExercise.solutionParticipation && programmingExercise.solutionParticipation.buildPlanId"
                        ><a href="https://bamboobruegge.in.tum.de/browse/{{ programmingExercise.solutionParticipation.buildPlanId }}" target="_blank">{{
                            programmingExercise.solutionParticipation.buildPlanId
                        }}</a></span
                    >
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.sequentialTestRuns.title">Sequential Test Runs</span></dt>
                <dd>
                    <span>{{ programmingExercise.sequentialTestRuns }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.publishBuildPlanUrl">Publish Build Plan Url</span></dt>
                <dd>
                    <span>{{ programmingExercise.publishBuildPlanUrl }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.allowOnlineEditor">Allow Online Editor</span></dt>
                <dd>
                    <span>{{ programmingExercise.allowOnlineEditor }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.programmingLanguage">Programming Language</span></dt>
                <dd>
                    <span jhiTranslate="{{ 'artemisApp.ProgrammingLanguage.' + programmingExercise.programmingLanguage }}">{{ programmingExercise.programmingLanguage }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.packageName">Package Name</span></dt>
                <dd>
                    <span>{{ programmingExercise.packageName }}</span>
                </dd>
                <dt><span jhiTranslate="artemisApp.exerciseLtiConfiguration.lti">LTI</span></dt>
                <dd>
                    <a [routerLink]="['/', { outlets: { popup: 'exercise/' + programmingExercise.id + '/lti-configuration' } }]">LTI Configuration</a>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.templateResult">Template Result</span></dt>
                <dd>
                    <div *ngIf="programmingExercise?.templateParticipation" class="d-flex align-items-center">
                        <jhi-updating-result
                            *ngIf="!loadingTemplateParticipationResults"
                            [exercise]="programmingExercise"
                            [participation]="programmingExercise.templateParticipation"
                            [showUngradedResults]="true"
                            [showTestNames]="true"
                            class="mr-2"
                        ></jhi-updating-result>
                        <jhi-programming-exercise-instructor-status
                            *ngIf="programmingExercise.templateParticipation.results?.length"
                            class="repository-status-icon mr-2"
                            [participationType]="ParticipationType.TEMPLATE"
                            [participation]="programmingExercise.templateParticipation"
                            [exercise]="programmingExercise"
                        ></jhi-programming-exercise-instructor-status>
                        <jhi-programming-exercise-instructor-trigger-build-button
                            *ngIf="programmingExercise.templateParticipation.results"
                            [exercise]="programmingExercise"
                            [participation]="programmingExercise.templateParticipation"
                        ></jhi-programming-exercise-instructor-trigger-build-button>
                    </div>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.solutionResult">Solution Result</span></dt>
                <dd>
                    <div *ngIf="programmingExercise?.solutionParticipation" class="d-flex align-items-center">
                        <jhi-updating-result
                            *ngIf="!loadingSolutionParticipationResults"
                            [exercise]="programmingExercise"
                            [participation]="programmingExercise.solutionParticipation"
                            [showUngradedResults]="true"
                            [showTestNames]="true"
                            class="mr-2"
                        ></jhi-updating-result>
                        <jhi-programming-exercise-instructor-status
                            *ngIf="programmingExercise.solutionParticipation.results?.length"
                            class="repository-status-icon mr-2"
                            [participationType]="ParticipationType.SOLUTION"
                            [participation]="programmingExercise.solutionParticipation"
                            [exercise]="programmingExercise"
                        ></jhi-programming-exercise-instructor-status>
                        <jhi-programming-exercise-instructor-trigger-build-button
                            *ngIf="programmingExercise.solutionParticipation.results"
                            [exercise]="programmingExercise"
                            [participation]="programmingExercise.solutionParticipation"
                        ></jhi-programming-exercise-instructor-trigger-build-button>
                    </div>
                </dd>
                <dt><span jhiTranslate="artemisApp.programmingExercise.problemStatement.title">Problem Statement</span></dt>
                <dd>
                    <jhi-programming-exercise-instructions
                        [exercise]="programmingExercise"
                        [participation]="programmingExercise.templateParticipation"
                    ></jhi-programming-exercise-instructions>
                </dd>
            </dl>

            <button type="submit" (click)="previousState()" class="btn btn-info mr-1">
                <fa-icon [icon]="'arrow-left'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.back"> Back</span>
            </button>

            <button type="button" [routerLink]="['/course', programmingExercise.course?.id, 'programming-exercise', programmingExercise.id, 'edit']" class="btn btn-primary mr-1">
                <fa-icon [icon]="'pencil-alt'"></fa-icon>&nbsp;<span jhiTranslate="entity.action.edit"> Edit</span>
            </button>
            <span class="mr-1">
                <button type="button" (click)="squashTemplateCommits()" class="btn btn-secondary">
                    <span jhiTranslate="artemisApp.programmingExercise.squashTemplateCommits">Squash Template Commits</span>
                </button>
                <fa-icon icon="question-circle" class="text-secondary" ngbTooltip="{{ 'artemisApp.programmingExercise.squashTemplateCommitsWarning' | translate }}"></fa-icon>
            </span>
            <span *ngIf="programmingExercise.programmingLanguage == JAVA" class="mr-1">
                <button type="button" (click)="generateStructureOracle()" class="btn btn-secondary">
                    <span jhiTranslate="artemisApp.programmingExercise.structureTestOracle">Update Structure Test Oracle</span>
                </button>
                <fa-icon icon="question-circle" class="text-secondary" ngbTooltip="{{ 'artemisApp.programmingExercise.structureTestOracleWarning' | translate }}"></fa-icon>
            </span>
        </div>
    </div>
</div>
